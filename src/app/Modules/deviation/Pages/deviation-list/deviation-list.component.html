<div class="deviation-list-page">
  <!-- Page header -->
  <div class="page-header">
    <h1 class="text-3xl font-bold text-text-primary">Deviations</h1>
    <a
      routerLink="/deviations/new"
      class="btn-primary focus-ring"
      aria-label="Create new deviation"
    >
      <svg
        class="w-5 h-5 inline-block mr-2"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
        aria-hidden="true"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 4v16m8-8H4"
        />
      </svg>
      New Deviation
    </a>
  </div>

  <!-- Filters -->
  <div class="filters-section card p-4 mb-6">
    <div class="flex gap-4 items-center">
      <input
        type="search"
        placeholder="Search deviations..."
        class="flex-1 px-4 py-2 border border-border rounded-lg focus-ring"
        #searchInput
        (input)="onSearch(searchInput.value)"
        aria-label="Search deviations"
      />
      <button
        type="button"
        (click)="clearFilters(); searchInput.value = ''"
        class="btn-secondary focus-ring"
      >
        Clear Filters
      </button>
    </div>
  </div>

  <!-- Loading state -->
  @if (loading()) {
    <div class="text-center py-12">
      <div
        class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary"
        role="status"
        aria-live="polite"
      >
        <span class="sr-only">Loading deviations...</span>
      </div>
    </div>
  }

  <!-- Error state -->
  @if (error()) {
    <div class="card bg-danger-light border-danger-border p-6 text-center">
      <p class="text-danger font-medium">{{ error() }}</p>
      <button
        type="button"
        (click)="loadDeviations()"
        class="btn-secondary mt-4 focus-ring"
      >
        Retry
      </button>
    </div>
  }

  <!-- Deviation list -->
  @if (!loading() && !error()) {
    @if (deviations().length > 0) {
      <div class="deviations-grid">
        @for (deviation of deviations(); track deviation.id) {
          <app-deviation-card [deviation]="deviation" />
        }
      </div>
    } @else {
      <div class="card p-12 text-center">
        <svg
          class="w-16 h-16 mx-auto text-text-muted mb-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
          />
        </svg>
        <h2 class="text-xl font-semibold text-text-primary mb-2">
          No deviations found
        </h2>
        <p class="text-text-secondary mb-6">
          Get started by creating your first deviation.
        </p>
        <a routerLink="/deviations/new" class="btn-primary focus-ring">
          Create Deviation
        </a>
      </div>
    }
  }
</div>

